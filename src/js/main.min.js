var draw=function(){function e(e,t){function n(e,t){return Math.random()>.5?-1:1}function i(){var i=[];"undefined"==typeof t&&(t=e,e=0);for(var s=e;t>=s;s++)i.push(s);return i.sort(n)}return i()}var t={online:{data:[],random:[],pCount:0},offline:{data:[],random:[],pCount:0}},n=function(){var e=4;$.ajax({url:"http://cbpc540.applinzi.com/index.php?s=/addon/GoodVoice/GoodVoice/getCheckinListIn2016&sportid="+e,dataType:"jsonp",callback:"JsonCallback"}).done(function(e){e.forEach(function(e,n){"0"==e.realtime?t.offline.data.push(e.user):t.online.data.push(e.user)}),i()})},i=function(){console.log("用户列表数据初始化完毕"),0!=t.online.data.length&&(t.online.random=e(t.online.data.length-1),t.offline.random=e(t.offline.data.length-1),t.online.pCount=0,t.offline.pCount=0)},s=function(e,n){if(0!=t.online.data.length){for(var s,o=[],a=t.online.pCount,l=!1,r=a;a+e>r;r++)s=r,t.online.pCount++,t.online.pCount>=t.online.random.length&&(t.online.pCount=0,l=!0),r>=t.online.random.length&&(s=r-t.online.random.length),o.push(t.online.data[t.online.random[s]]);for(a=t.offline.pCount,r=a;a+n>r;r++)s=r,t.offline.pCount++,t.offline.pCount>=t.offline.random.length&&(t.offline.pCount=0,l=!0),r>=t.offline.random.length&&(s=r-t.offline.random.length),o.push(t.offline.data[t.offline.random[r]]);return l&&i(),o}};return{init:n,reset:i,lottery:s}}(),app=function(){function e(e){if(e.requestFullscreen)e.requestFullscreen();else if(e.mozRequestFullScreen)e.mozRequestFullScreen();else if(e.msRequestFullscreen)e.msRequestFullscreen();else if(e.oRequestFullscreen)e.oRequestFullscreen();else if(e.webkitRequestFullscreen)e.webkitRequestFullScreen();else{var t=document.documentElement,n=document.body,i=document.getElementById("videobox"),s="width:100%;height:100%;overflow:hidden;";t.style.cssText=s,n.style.cssText=s,i.style.cssText=s+";margin:0px;padding:0px;",document.IsFullScreen=!0}}var t,n,i,s=[],o=23,a=(function(){for(var e=0;10>e;e++){s[e]=[];for(var t=0;(8>e?17:6)>t;t++)s[e].push(!1)}}(),{template:"#el-question",props:["question","type","src"]}),l=function(e,t){var n=questionList[e][t],i={question:n.question,answer:n.answer};return"undefined"!=typeof n.type&&(p.questionType=n.type,p.src=n.src,p.multiMediaStart=0,"undefined"!=n.start&&(p.multiMediaStart=n.start)),i},r={template:"#el-questionlist",props:["classlist","namelist"],methods:{selectQuestion:function(e){p.classlist[e]=!0,this.$message("选择了第"+e+"题");var t=l(p.typeID,e);p.question={title:t.question,answer:t.answer,shorter:t.question.length>o,shorterAnswer:t.answer.length>o-4,curID:0,showAnswer:!1,time:""},p.on=!p.on,p.isDraw=0}}},u={template:"#el-mask",props:["type","showmask","src"],methods:{hideMask:function(){p.showMask=!1,p.questionType==h.VIDEO&&p.flvPlayer.pause()}}},h={NONE:-1,IMG:0,AUDIO:1,VIDEO:2},c=["必答题 第一轮","必答题 第二轮","抢答题 第一轮","抢答题  第二轮","风险题(10分)","风险题(20分)","风险题(30分)","支部书记答题","观众答题","附加题"],p=new Vue({el:"#app",components:{"el-question":a,"el-questionlist":r,"el-mask":u},data:{on:!0,isDraw:0,typeID:0,flvPlayer:"",type:c[0],question:{},questionType:h.NONE,src:"",multiMediaStart:0,showMask:!1,classlist:s[0],nameList:[],luckyList:[],classOptions:[{label:"必答题",options:[{value:0,label:"第一轮"},{value:1,label:"第二轮"}]},{label:"抢答题",options:[{value:2,label:"第一轮"},{value:3,label:"第二轮"}]},{label:"风险题",options:[{value:4,label:"风险题 - 10分"},{value:5,label:"风险题 - 20分"},{value:6,label:"风险题 - 30分"}]},{label:"其它",options:[{value:7,label:"支部书记答题"},{value:8,label:"观众答题"},{value:9,label:"附加题"}]}]},watch:{typeID:function(){if(this.type=c[this.typeID],this.classlist=s[this.typeID],this.on||this.goback(),this.nameList=[],7==this.typeID)for(var e=0;17>e;e++)this.nameList.push(questionList[7][e].user)},isDraw:function(e){2==e&&p.$nextTick(function(){this.renderChart()})}},methods:{showAnswer:function(){this.on||(this.question.showAnswer=!0),t&&clearInterval(t)},renderChart:function(){var e=document.getElementById("chart"),t=echarts.init(e),i={colors:{white:"#FFF",whiteMedium:"rgba(255, 255, 255, 0.6)",whiteMediumLight:"rgba(255, 255, 255, 0.3)",whiteLight:"rgba(255, 255, 255, 0.2)",whiteLighter:"rgba(255, 255, 255, 0.1)",primary:"#556fb5",primaryLight:"#889acb"}},s=function(e){var t={color:["rgba(253,224,62,0.8)"],grid:{borderWidth:0,x:20,y:20,x2:20,y2:100},tooltip:{},xAxis:[{type:"category",data:[],axisLine:{show:0},axisTick:{show:0},boundaryGap:0,axisLabel:{textStyle:{color:i.colors.white,fontSize:18},formatter:function(e,t){return e.split("").join("\n")}},splitLine:{show:!1}}],yAxis:[{type:"value",splitLine:{show:!0,lineStyle:{type:"dashed",color:i.colors.whiteLight}},axisLine:{show:0},axisTick:{show:0},boundaryGap:0,axisLabel:{show:0}}],series:[{name:"得分",type:"bar",barMaxWidth:40,areaStyle:{normal:{color:i.colors.whiteMediumLight}},lineStyle:{normal:{width:1}},data:[],itemStyle:{normal:{width:1,label:{show:!0,textStyle:{fontSize:20,color:i.colors.white},position:"top"},barBorderRadius:2}},animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationDelay:function(e){return 50*e},animationDelayUpdate:function(e){return 100*e}}]};return e.map(function(e){t.xAxis[0].data.push(e.user),t.series[0].data.push(parseFloat(e.num).toFixed(0))}),t},o=function(){var e="http://cbpc540.applinzi.com/index.php?s=/addon/GoodVoice/GoodVoice/qualityHrOnlineScore";$.ajax({url:e,async:!1,dataType:"jsonp",callback:"JsonCallback"}).done(function(e){var n=s(e);t.setOption(n)})};o(),n=setInterval(function(){o()},3e3)},lightoff:function(){p.questionType!=h.NONE&&(this.showMask=!0,this.questionType=p.questionType,this.questionType==h.VIDEO&&this.$nextTick(function(){var t=this.src.split(".")[2];if(flvjs.isSupported()){var n=document.getElementById("videoElement");"MP4"==t?(this.flvPlayer=n,this.flvPlayer.src=this.src,this.flvPlayer.load(),this.flvPlayer.currentTime=this.multiMediaStart,e(n),this.flvPlayer.play()):(this.flvPlayer=flvjs.createPlayer({type:t,url:this.src}),this.flvPlayer.attachMediaElement(n),this.flvPlayer.load(),this.flvPlayer.play(),e(n),n.currentTime=this.multiMediaStart)}}))},goback:function(){this.question.showAnswer=!1,this.questionType==h.VIDEO&&""!=this.flvPlayer&&("flv"==this.src.split(".")[2]?(this.flvPlayer.pause(),this.flvPlayer.unload(),this.flvPlayer.detachMediaElement(),this.flvPlayer.destroy()):this.flvPlayer.pause()),this.on=!0,this.questionType=h.NONE,t&&clearInterval(t),i&&clearInterval(i),n&&clearInterval(n),this.isDraw=0,this.type=c[this.typeID]},timing:function(){if(!this.on){t&&clearInterval(t),this.question.time=5==this.typeID||6==this.typeID?10*this.typeID-30:10,this.question.showAnswer=!1;var e=this;t=setInterval(function(){e.question.time--,0===e.question.time&&(e.question.time="时间到",clearInterval(t),e.showMask=!1)},1e3)}},startLottery:function(e){this.type=1==e?"中奖人信息":"得分排名",this.isDraw=e,this.luckyList=[]},stopLottery:function(){"undefined"!=typeof i&&clearInterval(i)},lottery:function(e){this.isDraw=1,this.luckyList=[],this.stopLottery(),i=setInterval(function(){p.luckyList=draw.lottery(3,e>3?2:0)},100)}}});return{vm:p}}();$(function(){$(".content").height($(document).height()),draw.init()});
//# sourceMappingURL=main.min.js.map